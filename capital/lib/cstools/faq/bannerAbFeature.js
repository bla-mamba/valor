!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("bannerAbFeature",[],e):"object"==typeof exports?exports.bannerAbFeature=e():t.bannerAbFeature=e()}(self,function(){return function(){"use strict";var t={d:function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(t,e,n){return(e=a(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,a(o.key),o)}}function a(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}function u(){return Date.now()/1e3|0}t.r(e),t.d(e,{default:function(){return v}}),window.$requestUtil||(window.$requestUtil={sstm:u(),request_id:0,uuid:$util.uuidv4(),infoReported:!1,ccpSessionId:void 0,clientLabel:"IB"});var c="alpha"===window.env||location.href.includes("nightly"),l=$requestUtil.uuid,d=$requestUtil.sstm,f=function(t,e){e&&(t=null),window.nativeConsole&&"function"==typeof nativeConsole.log&&nativeConsole.log(t),"function"==typeof window.__logger?window.__logger(t):Array.isArray(window.__logs)&&__logs.push([(new Date).toLocaleString(),t])},p=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.headers={},this.baseUrlOverride="",this.paramsPreprocessors=[]},e=[{key:"getBase",value:function(){var t="".concat(document.location.origin,"/tws.proxy");return this.baseUrlOverride||t}},{key:"formatUrl",value:function(t){return 0===t.indexOf("http")?t:this.getBase()+"/"+t}},{key:"addParamsPreprocessor",value:function(t){var e=this;return this.paramsPreprocessors.push(t),function(){e.paramsPreprocessors=e.paramsPreprocessors.filter(function(e){return e!==t})}}},{key:"formatParams",value:function(t){var e,n=$util.cookie("XYZAB"),o=r({"Content-Type":"application/json; charset=utf-8","x-session-id":$requestUtil.uuid,"x-request-id":$requestUtil.request_id++,"X-SERVICE":"AM.LOGIN","x-embedded-in":"web","X-WA-VERSION":["021e0a7","Thu, 21 Aug 2025 17:18:38 +0000"]+"/2025-08-21T17:35:20.368Z","x-ccp-session-id":$requestUtil.ccpSessionId,"x-client-label":$requestUtil.clientLabel},c?{"x-build":"nightly"}:{});null!=(e=n)&&"null"!==(""+e).toLowerCase()&&"undefined"!==(""+e).toLowerCase()&&/^[a-zA-Z0-9!@#$&()`.+,/"-]/i.exec(e)&&(o["X-XYZAB"]=n);var i=r({credentials:"include",headers:o},t);return this.paramsPreprocessors.reduce(function(t,e){return t=e(t)},i)}},{key:"overrideBase",value:function(t){this.baseUrlOverride=t}},{key:"request",value:function(t,e,n){return f("WA > requesting ".concat(t," with params ").concat(JSON.stringify(e)),n),fetch(this.formatUrl(t),this.formatParams(e)).then(function(e){var o,r,i,s,a,u;e.ok||(window.__appName,null===(o=window)||void 0===o||null===(r=o.navigator)||void 0===r||r.userAgent,null===(i=window)||void 0===i||null===(s=i.navigator)||void 0===s||s.platform,null===(a=window)||void 0===a||null===(u=a.navigator)||void 0===u||u.appVersion,$app.option.theme,$app.option.language,$media,$device,window.region,e.status,e.statusText,e.url);if(e.clone){var c=e.clone();if(c&&c.status&&"401"===c.status.toString())return $app.send({action:"sso_validation_failed"}),Promise.reject({status:e.status,statusText:e.statusText,message:"Session Expired"});c.ok?c.text().then(function(e){f("WA > ".concat(t," SUCCESS with response ").concat(e," statusText ").concat(c.statusText," statusCode ").concat(c.status),n)}).catch(function(e){f("WA > ".concat(t," FAILED with response error message ").concat(e?e.message:"Unknown"," statusText ").concat(c.statusText," statusCode ").concat(c.status),n)}):c.text().then(function(e){f("WA > ".concat(t," FAILED with response ").concat(e," statusText ").concat(c.statusText," statusCode ").concat(c.status),n)}).catch(function(e){f("WA > ".concat(t," FAILED with response error message ").concat(e?e.message:"Unknown"," statusText ").concat(c.statusText," statusCode ").concat(c.status),n)})}else f("WA > ".concat(t," SUCCESS with response ").concat(e," statusText ").concat(e&&e.statusText," statusCode ").concat(e&&e.status),n);return e}).catch(function(e){return f("WA > ".concat(t," FAILED with response ").concat(e?e.message:"Unknown"),n),e})}},{key:"nonAuthTelemetry",value:function(t){return this.request("telemetry/noAuthAdd",{method:"POST",body:JSON.stringify(t)}).then(function(t){if(t.ok)return t.json();throw"Failed non auth telemetry"})}},{key:"reportTelemetry",value:function(t){var e,n,o=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=null===(e={mode:"production",env:"production",rev:["021e0a7","Thu, 21 Aug 2025 17:18:38 +0000"],platform:"web",date:"2025-08-21T17:35:20.368Z"})||void 0===e?void 0:e.platform,c=$requestUtil.infoReported?void 0:r({prod:"production"==(null===(n={mode:"production",env:"production",rev:["021e0a7","Thu, 21 Aug 2025 17:18:38 +0000"],platform:"web",date:"2025-08-21T17:35:20.368Z"})||void 0===n?void 0:n.env)?1:0},s),f=["web","desktop","ntws","marketing"].includes(a)||t.useREST;delete t.useREST;var p={wa_session:l,sstm:d,t:u()-d},y=r(r({},t),p);if(f){$requestUtil.infoReported=!0;var m={sstm:d,info:c,data:y};return s&&!1===s.authenticated?this.nonAuthTelemetry(r({user:i},m)):this.request("telemetry/authAdd",{method:"POST",body:JSON.stringify(m)}).then(function(t){var e,n;if(!t.ok&&["401","400"].includes((null===(e=t.status)||void 0===e?void 0:e.toString())||(null===(n=t.statusCode)||void 0===n?void 0:n.toString())))return o.nonAuthTelemetry(r({user:i},m));if(t.ok)return t.json();throw"Failed auth telemetry"}).catch(function(t){console.log(t)})}$app.send({action:"web_app_telemetry",data:y})}}],e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),y=new p;const m=y;function v(t){return"chat"===t?Promise.resolve(!1):new Promise(function(t,e){m.request("abtesting/features/IBOT_WEB_APP",{method:"POST",body:JSON.stringify({type:"featuresMsg",datetime:$date.utc().toString(),context:{applicationId:"IBOT_WEB_APP",features:{SELFSERV_BANNER:0}}})}).then(function(t){if(t.ok)return t.json();throw t.code}).then(function(e){if(!e.context.features.SELFSERV_BANNER||""+e.context.features.SELFSERV_BANNER!="1")throw"Feature SELFSERV_BANNER disabled";t(!0)}).catch(function(){t(!1)})})}return e}()});